<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to the MLOps Project</title>
    <link rel="stylesheet" href="../static/styles.css">
</head>
<body class="container">
    <header>
        <h1>
        Search recipes
        </h1>
        <form action="">
            <input
            type="search"
            name="query"
            placeholder="Search"
            aria-label="Search"
            />
            <input type="submit" value="Search" />
        </form>
    </header>
    <main>
        <section class="results">
        </section>
    </main>
    <footer>

    </footer>
    <script>
        const form = document.querySelector('form');
        const resultsSection = document.querySelector('.results');

        form.addEventListener('submit', async (event) => {
            event.preventDefault();
            const query = form.query.value;
            resultsSection.innerHTML = '<p>Loading...</p>';

            try {
                const response = await fetch(`http://localhost:8000/recherche/recettes/?query=${query}`);
                const data = await response.json();

                if (data.error) {
                    resultsSection.innerHTML = `<p>Error: ${data.error}</p>`;
                    return;
                }

                if (data.results.length === 0) {
                    resultsSection.innerHTML = '<p>No results found.</p>';
                    return;
                }

                resultsSection.innerHTML = data.results.map(recipe => `
                    <div class="recipe">
                        <h2>${recipe.title}</h2>
                    </div>
                `).join('');
            } catch (error) {
                resultsSection.innerHTML = `<p>Error fetching results: ${error.message}</p>`;
            }
        });
    </script>
</body>
</html>